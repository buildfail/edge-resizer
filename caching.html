<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>🚀 Caching | 🔳 Edge Resizer</title>
    <meta name="description" content="Cache, transform and optimize image responses from your site">
    <link rel="stylesheet" href="/assets/style.419afbd2.css">
    <link rel="modulepreload" href="/assets/Home.cf38ee11.js">
    <link rel="modulepreload" href="/assets/AlgoliaSearchBox.1c232338.js">
    <link rel="modulepreload" href="/assets/app.2733a36c.js">
    <link rel="modulepreload" href="/assets/caching.md.2588a43e.lean.js">
    <link rel="modulepreload" href="/assets/app.2733a36c.js">
    <meta name="twitter:title" content="🚀 Caching | 🔳 Edge Resizer">
    <meta property="og:title" content="🚀 Caching | 🔳 Edge Resizer">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme"><header class="nav-bar" data-v-675d8756><div class="sidebar-button" data-v-675d8756><svg class="icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z" class></path></svg></div><a class="nav-bar-title" href="/" aria-label="🔳 Edge Resizer, back to home" data-v-675d8756 data-v-4a583abe><!----> 🔳 Edge Resizer</a><div class="flex-grow" data-v-675d8756></div><div class="nav" data-v-675d8756><nav class="nav-links" data-v-675d8756 data-v-eab3edfe><!--[--><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item isExternal" href="https://images.weserv.nl/" target="_blank" rel="noopener noreferrer" data-v-b8818f8c>Images.weserv.nl <svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-b8818f8c><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item isExternal" href="https://developers.cloudflare.com/workers/" target="_blank" rel="noopener noreferrer" data-v-b8818f8c>Cloudflare Workers <svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-b8818f8c><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></div><!--]--><!----><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item isExternal" href="https://github.com/ctohm/edge-resizer" target="_blank" rel="noopener noreferrer" data-v-b8818f8c>GitHub <svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-b8818f8c><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></div></nav></div><!--[--><!--[--><div class="algolia-search-box" id="docsearch"></div><!--]--><!--]--></header><aside class="sidebar" data-v-83e92a68><nav class="nav-links nav" data-v-83e92a68 data-v-eab3edfe><!--[--><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item isExternal" href="https://images.weserv.nl/" target="_blank" rel="noopener noreferrer" data-v-b8818f8c>Images.weserv.nl <svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-b8818f8c><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item isExternal" href="https://developers.cloudflare.com/workers/" target="_blank" rel="noopener noreferrer" data-v-b8818f8c>Cloudflare Workers <svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-b8818f8c><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></div><!--]--><!----><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item isExternal" href="https://github.com/ctohm/edge-resizer" target="_blank" rel="noopener noreferrer" data-v-b8818f8c>GitHub <svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-b8818f8c><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></div></nav><!--[--><!--]--><ul class="sidebar-links" data-v-83e92a68><!--[--><li class="sidebar-link"><a class="sidebar-link-item" href="/about">🍬 About</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/routing">🔌 Routing Strategy</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/resizing_and_cropping">🔳 Resize, Crop, Align</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/format">🔃 Format Conversion</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/transformations">♻️ Effects &amp; Filters</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/feature_detection">💊 Feature Detection</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/caching">🚀 Caching</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/deploy">📡 Deploying</a><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/hotlinking">🔗 Hotlink at will</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/library">📙 Use it as a library</a><!----></li></ul></li><li class="sidebar-link"><a class="sidebar-link-item" href="/use_cases">⛳ Use Cases</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/troubleshooting">💥 Troubleshooting</a><!----></li><!--]--></ul><!--[--><!--]--></aside><!-- TODO: make this button accessible --><div class="sidebar-mask"></div><main class="page" data-v-7eddb2c4><div class="container" data-v-7eddb2c4><!--[--><!--]--><div style="position:relative;" class="content" data-v-7eddb2c4><div><h1 id="frontmatter-title" tabindex="-1">🚀 Caching <a class="header-anchor" href="#frontmatter-title" aria-hidden="true">#</a></h1><hr><div class="showcase"><div class="left_text"><!--[--><br> Variations are generated on demand, at which point they are stored in Cloudflare&#39;s Edge Cache. <b>Ephemeral but long lived</b>, further requests will receive a cached response at blazing speed. <!--]--><br><p><!--[-->Above caching logic does Populating the edge cache this way <!--]--></p></div><div class="image_div"><!--[--><div class="labeledImageContainer"><div class="imagecell"><img src="https://resizer.pictures/w=150_h=150/riff.one/images/designcue-unsplash.jpg"></div><div class="captioncell"><!--[-->w=150_h=150<!--]--></div></div><!--]--></div></div><h3 id="canonicalizing-transformations" tabindex="-1">Canonicalizing Transformations <a class="header-anchor" href="#canonicalizing-transformations" aria-hidden="true">#</a></h3><p>The order of the search parameters doesn&#39;t affect the final outcome. However, the stringified version of the URL would be different, creating two cache entries for the same image variation. To prevent this situation, the internal routing logic of Edge Resizer figures it out so you don&#39;t have to.</p><p>The next two URLs are equivalent</p><div class="language-erlang"><pre><code><span class="token atom">https</span><span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token atom">resizer</span><span class="token punctuation">.</span><span class="token atom">pictures</span><span class="token operator">/</span><span class="token atom">il_w</span><span class="token operator">=</span><span class="token number">150</span><span class="token variable">_h</span><span class="token operator">=</span><span class="token number">150</span><span class="token operator">/</span><span class="token atom">riff</span><span class="token punctuation">.</span><span class="token atom">one</span><span class="token operator">/</span><span class="token atom">images</span><span class="token operator">/</span><span class="token atom">designcue</span><span class="token operator">-</span><span class="token atom">unsplash</span><span class="token punctuation">.</span><span class="token atom">jpg</span>

<span class="token atom">https</span><span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token atom">resizer</span><span class="token punctuation">.</span><span class="token atom">pictures</span><span class="token operator">/</span><span class="token atom">h</span><span class="token operator">=</span><span class="token number">150</span><span class="token variable">_il_w</span><span class="token operator">=</span><span class="token number">150</span><span class="token operator">/</span><span class="token atom">riff</span><span class="token punctuation">.</span><span class="token atom">one</span><span class="token operator">/</span><span class="token atom">images</span><span class="token operator">/</span><span class="token atom">designcue</span><span class="token operator">-</span><span class="token atom">unsplash</span><span class="token punctuation">.</span><span class="token atom">jpg</span>

</code></pre></div><p>Regarding parameters that are provided as shortcuts for others, as in the case of <code>png</code> as a shortcut for <code>output=png</code>, canonicalization resolves those shortcuts before computing the cached entry. The next two URLs are equivalent</p><div class="language-html"><pre><code>https://resizer.pictures/output=png/riff.one/images/designcue-unsplash.jpg

https://resizer.pictures/png/riff.one/images/designcue-unsplash.jpg

</code></pre></div><p>In cases where the original image is transformed according to feature detections (as in the case of <code>webp</code> format in <code>auto</code> mode ), detected feature is merged into the canonical URL before caching. If you&#39;re using a browser with webp support, the following URLs are equivalent:</p><div class="language-html"><pre><code>https://resizer.pictures/output=auto/riff.one/images/dice.png

https://resizer.pictures/auto/riff.one/images/dice.png

https://resizer.pictures/webp/riff.one/images/dice.png

// any of the above is translated to
https://resizer.pictures/output=webp/riff.one/images/dice.png

</code></pre></div><h2 id="cache-busting" tabindex="-1">Cache Busting <a class="header-anchor" href="#cache-busting" aria-hidden="true">#</a></h2><p>TBD. For now, you can play with the <code>MAX_AGE</code> environment variable (affects the weserve request) and passing searchParam <code>nocache=1</code>. Setting <code>MAX_AGE = &#39;1d&#39;</code> and <code>nocache=1</code> isn&#39;t really real-time, but it&#39;s something.</p><p>BTW, errored responses aren&#39;t cached, so that scenario is already taken care of.</p></div></div><footer class="page-footer" data-v-7eddb2c4 data-v-fb8d84c6><div class="edit" data-v-fb8d84c6><div class="edit-link" data-v-fb8d84c6 data-v-1ed99556><a class="link" href="https://github.com/ctohm/edge-resizer/edit/master/docs/caching.md" target="_blank" rel="noopener noreferrer" data-v-1ed99556>Edit this page <svg class="icon outbound icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-1ed99556><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></div><div class="updated" data-v-fb8d84c6><!----></div></footer><!----><!--[--><!--]--></div></main></div><!----><!--]--></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"about.md\":\"5db0d0ae\",\"caching.md\":\"2588a43e\",\"deploy.md\":\"51c62c47\",\"feature_detection.md\":\"ba37460b\",\"format.md\":\"7af70e90\",\"hotlinking.md\":\"1a50d48d\",\"index.md\":\"4ca56e72\",\"library.md\":\"a8bb8fe8\",\"parameters.md\":\"c0dd2a39\",\"resizing_and_cropping.md\":\"063b3978\",\"routing.md\":\"4e879c7a\",\"transformations.md\":\"28479f35\",\"troubleshooting.md\":\"8278770f\",\"use_cases.md\":\"f1a3b226\"}")</script>
    <script type="module" async src="/assets/app.2733a36c.js"></script>
    
  </body>
</html>